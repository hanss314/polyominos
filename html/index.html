<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>polyomino example</title>
  </head>
  <body>
    <script type="module">
      import init, {validate_header, get_polyomino, get_orders} from "./pkg/polyominos.js";

      const fetchBinaryData = (location) => {
        const xhr = new XMLHttpRequest();
        xhr.responseType = 'arraybuffer';
        return new Promise(function(resolve, reject) {
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status >= 300) {
                        reject(new Error('Error, status code = ' + xhr.status));
                    } else {
                        resolve(xhr.response);
                    }
                }
            };
            xhr.open('get', location, true);
            xhr.send();
        });
      };

      init().then(async () => {
        const data = new Uint8Array(await fetchBinaryData("/twelve.pif"));
        console.log(validate_header(data));
        const order_map = get_orders(data);
        console.log(order_map);
        console.log(get_polyomino(data, 5, 20, order_map));
      });
    </script>
  </body>
</html>
